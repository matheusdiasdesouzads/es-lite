# AST tasks

- [x] Type expressions
  - [x] Identifier
  - [x] Any
  - [x] Void
  - [x] Undefined
  - [x] Null
  - [x] Function
  - [x] Array
  - [x] Tuple
  - [x] Record
  - [x] Parentheses
  - [x] Union
  - [x] Member
  - [x] Generic instantiation
  - [x] Nullable
  - [x] Non-nullable
  - [x] Typed type expression
- [x] Variable binding
- [x] Simple variable declaration
- [x] Destructuring patterns
  - [x] `VerifyDestructuringPattern(pattern, readOnly, output, visibility, inferredType);`
    - This is used for binding patterns.
  - [x] `VerifyAssignmentDestructuringPattern(pattern, type);`
    - This is used by assignment expressions.
  - [x] Bind
  - [x] Array
  - [x] Record
- [x] Constant Expressions
  - [x] `VerifyConstantExp(exp, faillible, expectedType?)`
  - [x] `LimitConstantExpType(exp, toType, faillible?)`
    - [x] `LimitStrictConstantExpType`
      - Limits constant expression's type without implicit conversion.
  - [x] Identifier
  - [x] Unary
  - [x] Binary
  - [x] Default
  - [x] Object initializer
  - [x] Array initializer
  - [x] Member
  - [x] String literal
  - [x] Null literal
  - [x] Boolean literal
  - [x] Numeric literal
  - [x] Conditional
  - [x] Parentheses
  - [x] List
- [x] Expressions
  - [x] `VerifyExp(exp, expectedType?, instantiatingGeneric?, writting?)`
  - [x] `VerifyExpAsValue(exp, expectedType?, instantiatingGeneric?, writting?)`
    - Verifies expression and fails if it is not a value.
  - [x] `LimitExpType(exp, toType)`
    - [x] `LimitStrictExpType(exp, toType)`
      - Limits expression's type without implicit conversion.
  - [x] Identifier
  - [x] Member
  - [x] `import.meta`
  - [x] Embed
  - [x] Unary
    - [x] Await
    - [x] Yield
    - [x] Delete
    - [x] Typeof
    - [x] Void
    - [x] Logical not
    - [x] Positive
    - [x] Negate
    - [x] Bitwise not
    - [x] Non-null
    - [x] Pre-increment
    - [x] Pre-decrement
    - [x] Post-increment
    - [x] Post-decrement
  - [x] Binary
    - [x] In
    - [x] Equals, not equals
    - [x] Strict equals, strict not equals
    - [x] Logical and, logical xor, logical or
    - [x] Null coalescing
    - [x] Add, subtract, multiply, divide, remainder, power, bitwise and, bitwise xor, bitwise or, left shift, right shift, unsigned right shift, less than, greater than, less than or equals, greater than or equals
  - [x] Type binary (`as is instanceof`)
    - [ ] `bindsTo`. Currently unimplemented, so throw a VerifyError when it is used.
  - [x] Default
  - [x] Function
  - [x] Object initializer
  - [x] Array initializer
  - [x] Markup initializer
  - [x] Markup list initializer
  - [x] Index
    - [x] Possibly `?.[k]`
  - [x] Call
    - [x] Possibly `?.()`
  - [x] This literal
  - [x] String literal
  - [x] Null literal
  - [x] Boolean literal
  - [x] Numeric literal
  - [x] `RegExp` literal
  - [x] Conditional
  - [x] Parentheses
  - [x] List
  - [x] Generic instantiation
  - [x] Assignment
    - [x] When verifying left-hand side, pass `writting = true`.
  - [x] New
  - [x] Super
- [x] Program
- [x] Package definitions
- [x] Generics
- [ ] Statements
  - [ ] Declarations
    - [x] Import directive (phased)
      - [x] `VerifyPhase.Phase2`
      - [x] `VerifyPhase.ImportOrAliasPhase1`
      - [x] `VerifyPhase.ImportOrAliasPhase2`
    - [x] Use namespace directive (phased)
      - [x] `VerifyPhase.Phase2`
      - [x] `VerifyPhase.ImportOrAliasPhase1`
      - [x] `VerifyPhase.ImportOrAliasPhase2`
    - [ ] Namespaces
      - [ ] `VerifyPhase.Phase1`
        - [ ] Create namespace frame and attach it to the definition
        - [ ] Visit block with phase 1
      - [ ] `VerifyPhase.Phase2`
      - [ ] `VerifyPhase.Phase3`
      - [ ] `VerifyPhase.Phase4`
      - [ ] `VerifyPhase.Phase5`
      - [ ] `VerifyPhase.Phase6`
      - [ ] `VerifyPhase.Phase7`
    - [x] Namespace alias
      - [x] `VerifyPhase.Phase2`
      - [x] `VerifyPhase.ImportOrAliasPhase1`
      - [x] `VerifyPhase.ImportOrAliasPhase2`
    - [ ] Variables
      - [ ] `VerifyPhase.Phase1`
        - [ ] Assign `type.ParentDefinition` to `m_Frame.TypeFromFrame ?? m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
      - [ ] `VerifyPhase.Phase2`
      - [ ] `VerifyPhase.Phase3`
      - [ ] `VerifyPhase.Phase4`
      - [ ] `VerifyPhase.Phase5`
      - [ ] `VerifyPhase.Phase6`
      - [ ] `VerifyPhase.Phase7`
    - [ ] Functions
      - [ ] Ordinary (`Ast.FunctionDefinition`)
        - [ ] `VerifyPhase.Phase1`
          - [ ] Assign `type.ParentDefinition` to `m_Frame.TypeFromFrame ?? m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
          - [ ] If part of an interface, add `OptionalInterfaceMethod` flag to method slot
        - [ ] `VerifyPhase.Phase2`
          - [ ] Call `FragmentedB_VerifyTypeParameters` for generics
        - [ ] `VerifyPhase.Phase3`
        - [ ] `VerifyPhase.Phase4`
        - [ ] `VerifyPhase.Phase5`
        - [ ] `VerifyPhase.Phase6`
        - [ ] `VerifyPhase.Phase7`
      - [ ] Constructor (`Ast.ConstructorDefinition`)
        - [ ] `VerifyPhase.Phase1`
          - [ ] Add `Constructor` flag to method slot
        - [ ] `VerifyPhase.Phase2`
        - [ ] `VerifyPhase.Phase3`
        - [ ] `VerifyPhase.Phase4`
        - [ ] `VerifyPhase.Phase5`
        - [ ] `VerifyPhase.Phase6`
        - [ ] `VerifyPhase.Phase7`
      - [ ] Proxy (`Ast.ProxyDefinition`)
        - [ ] `VerifyPhase.Phase1`
        - [ ] `VerifyPhase.Phase2`
        - [ ] `VerifyPhase.Phase3`
        - [ ] `VerifyPhase.Phase4`
        - [ ] `VerifyPhase.Phase5`
        - [ ] `VerifyPhase.Phase6`
        - [ ] `VerifyPhase.Phase7`
      - [ ] Getter (`Ast.GetterDefinition`)
        - [ ] `VerifyPhase.Phase1`
          - [ ] Assign `type.ParentDefinition` to `m_Frame.TypeFromFrame ?? m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
          - [ ] If part of an interface, add `OptionalInterfaceMethod` flag to method slot
        - [ ] `VerifyPhase.Phase2`
        - [ ] `VerifyPhase.Phase3`
        - [ ] `VerifyPhase.Phase4`
        - [ ] `VerifyPhase.Phase5`
        - [ ] `VerifyPhase.Phase6`
        - [ ] `VerifyPhase.Phase7`
      - [ ] Setter (`Ast.SetterDefinition`)
        - [ ] `VerifyPhase.Phase1`
          - [ ] Assign `type.ParentDefinition` to `m_Frame.TypeFromFrame ?? m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
          - [ ] If part of an interface, add `OptionalInterfaceMethod` flag to method slot
        - [ ] `VerifyPhase.Phase2`
        - [ ] `VerifyPhase.Phase3`
        - [ ] `VerifyPhase.Phase4`
        - [ ] `VerifyPhase.Phase5`
        - [ ] `VerifyPhase.Phase6`
        - [ ] `VerifyPhase.Phase7`
    - [ ] Classes
      - [ ] `VerifyPhase.Phase1`
        - [ ] Assign `type.ParentDefinition` to `m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
        - [ ] If duplicate, reuse type parameters.
        - [ ] Create class frame and attach it to the definition
        - [ ] Visit block with phase 1
      - [ ] `VerifyPhase.Phase2`
        - [ ] Resolve `extends` and `implements` clauses.
        - [ ] Call `AddLimitedKnownSubtype` after resolving super type
        - [ ] Call `FragmentedB_VerifyTypeParameters` for generics
      - [ ] `VerifyPhase.Phase3`
      - [ ] `VerifyPhase.Phase4`
      - [ ] `VerifyPhase.Phase5`
      - [ ] `VerifyPhase.Phase6`
      - [ ] `VerifyPhase.Phase7`
    - [ ] Interfaces
      - [ ] `VerifyPhase.Phase1`
        - [ ] Assign `type.ParentDefinition` to `m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
        - [ ] If duplicate, reuse type parameters.
        - [ ] Create interface frame and attach it to the definition
        - [ ] Visit block with phase 1
      - [ ] `VerifyPhase.Phase2`
        - [ ] Resolve `extends` clause if any.
        - [ ] Call `AddLimitedKnownSubtype` after resolving super type
        - [ ] Call `FragmentedB_VerifyTypeParameters` for generics
      - [ ] `VerifyPhase.Phase3`
      - [ ] `VerifyPhase.Phase4`
      - [ ] `VerifyPhase.Phase5`
      - [ ] `VerifyPhase.Phase6`
      - [ ] `VerifyPhase.Phase7`
    - [ ] Enums
      - [ ] `VerifyPhase.Phase1`
        - [ ] Assign `type.ParentDefinition` to `m_Frame.NamespaceFromFrame ?? m_Frame.PackageFromFrame`
        - [ ] Create enum frame and attach it to the definition
        - [ ] Visit block with phase 1, but don't use `fragmented_verifyStatementSeq`; call it for all directives except for variable definitions without `static` modifier.
      - [ ] `VerifyPhase.Phase2`
        - [ ] Resolve the `wraps` clause if any.
        - [ ] Fully resolve variable definitions without `static` modifier, resulting in new enum variants.
        - [ ] Call `enumType.EnumInitializeMethods`
      - [ ] `VerifyPhase.Phase3`
      - [ ] `VerifyPhase.Phase4`
      - [ ] `VerifyPhase.Phase5`
      - [ ] `VerifyPhase.Phase6`
      - [ ] `VerifyPhase.Phase7`
    - [x] Types
      - [x] `VerifyPhase.Phase2`
      - [x] `VerifyPhase.Phase3`
      - [x] `VerifyPhase.ImportOrAliasPhase1`
      - [x] `VerifyPhase.ImportOrAliasPhase2`
  - [x] Expression statement
  - [x] Empty statement
  - [x] Block
  - [x] Super statement
  - [x] Import
  - [x] If
  - [x] Do
  - [x] While
  - [x] Break
  - [x] Continue
  - [x] Return
  - [x] Throw
  - [x] Try
  - [x] Labeled statement
  - [x] For
  - [x] `for..in`
  - [x] `for each`
  - [x] Switch
  - [x] `switch type`
  - [x] Include
  - [x] `use namespace`
  - [x] `use resource`
  - [x] With
